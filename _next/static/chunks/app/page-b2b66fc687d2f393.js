(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2524:(e,t,a)=>{"use strict";a.d(t,{default:()=>w});var r=a(5155),n=a(2115);let l="swimmingly-tide-preference",o="swimmingly-conditions-cache",s={waterQuality:{enterococcus:{safe:104,advisory:500,dangerous:1e3},coliform:{safe:200,advisory:1e3,dangerous:2e3}},waves:{calm:2,safe:3,moderate:5,rough:8},wind:{calm:5,light:10,moderate:15,strong:20,veryStrong:25},current:{slack:.3,slow:.5,moderate:1,strong:1.5,veryStrong:2},sso:{cautionDays:3,warningDays:7,proximityMiles:2},tide:{slackWindow:.5,lowCurrent:1,moderateCurrent:2,phasePreference:{slack:100,flood:85,ebb:85}},damReleases:{low:3e4,moderate:5e4,high:8e4,extreme:1e5}},i={waterQuality:30,tideAndCurrent:25,waves:20,weather:15,damReleases:10},c={excellent:{min:80,max:100,label:"Excellent",color:"#22c55e"},good:{min:60,max:79,label:"Good",color:"#3b82f6"},fair:{min:40,max:59,label:"Fair",color:"#f59e0b"},poor:{min:20,max:39,label:"Poor",color:"#ef4444"},dangerous:{min:0,max:19,label:"Dangerous",color:"#991b1b"}},d=[{value:"slack",label:"Slack",description:"Minimal water movement between tides"},{value:"flood",label:"Flood",description:"Incoming/rising tide"},{value:"ebb",label:"Ebb",description:"Outgoing/falling tide"}];function u(e){let{preference:t,onChange:a,isLoading:n=!1}=e;return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Preferred Tide Phase"}),n&&(0,r.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Loading..."})]}),(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Select your preferred tide phase to personalize your swim score"}),(0,r.jsx)("div",{className:"space-y-2",children:d.map(e=>(0,r.jsxs)("label",{className:"\n              flex items-start p-3 rounded-lg border-2 cursor-pointer transition-all\n              ".concat(t===e.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-gray-300 dark:hover:border-gray-600","\n              ").concat(n?"opacity-50 cursor-not-allowed":"","\n            "),children:[(0,r.jsx)("input",{type:"radio",name:"tide-phase",value:e.value,checked:t===e.value,onChange:e=>a(e.target.value),disabled:n,className:"mt-0.5 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 dark:border-gray-600"}),(0,r.jsxs)("div",{className:"ml-3 flex-1",children:[(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e.label})}),(0,r.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-0.5",children:e.description})]})]},e.value))}),(0,r.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 pt-2 border-t border-gray-200 dark:border-gray-700",children:"Your preference is saved locally and will affect your swim score calculation"})]})}function m(e){let{score:t,tidePreference:a,onTidePreferenceChange:n,isPreferenceLoaded:l}=e,{overallScore:o,rating:s,warnings:i,recommendations:d}=t,m=c[s].color;return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-800 dark:text-gray-200",children:"Current Swim Score"}),(0,r.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,r.jsx)("div",{className:"relative w-48 h-48 rounded-full flex items-center justify-center",style:{background:"conic-gradient(".concat(m," ").concat(o,"%, #e5e7eb ").concat(o,"%)")},children:(0,r.jsxs)("div",{className:"absolute w-40 h-40 bg-white dark:bg-gray-800 rounded-full flex flex-col items-center justify-center",children:[(0,r.jsx)("div",{className:"text-5xl font-bold",style:{color:m},children:o}),(0,r.jsx)("div",{className:"text-lg font-semibold mt-1 text-gray-600 dark:text-gray-400 uppercase",children:s})]})})}),d.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Recommendations"}),(0,r.jsx)("ul",{className:"space-y-1",children:d.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-green-700 dark:text-green-400 flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"âœ“"}),(0,r.jsx)("span",{children:e})]},t))})]}),i.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Warnings"}),(0,r.jsx)("ul",{className:"space-y-1",children:i.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-red-700 dark:text-red-400 flex items-start",children:[(0,r.jsx)("span",{className:"mr-2",children:"âš "}),(0,r.jsx)("span",{children:e})]},t))})]}),(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsx)(u,{preference:a,onChange:n,isLoading:!l})}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,r.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last updated: ",new Date(t.timestamp).toLocaleTimeString()]})})]})}function h(e){let{title:t,value:a,unit:n,secondaryValue:l,secondaryUnit:o,threshold:s,status:i="info",details:c,icon:d}=e;return(0,r.jsxs)("div",{className:"rounded-lg border-2 p-4 ".concat({good:"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800",warning:"bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800",danger:"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800",info:"bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800"}[i]),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:t}),d&&(0,r.jsx)("span",{className:"text-2xl",children:d})]}),(0,r.jsxs)("div",{className:"text-3xl font-bold ".concat({good:"text-green-800 dark:text-green-200",warning:"text-yellow-800 dark:text-yellow-200",danger:"text-red-800 dark:text-red-200",info:"text-blue-800 dark:text-blue-200"}[i]),children:[a,n&&(0,r.jsx)("span",{className:"text-xl ml-1",children:n}),void 0!==l&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-xl mx-2 text-gray-400",children:"|"}),l,o&&(0,r.jsx)("span",{className:"text-xl ml-1",children:o})]})]}),s&&(0,r.jsx)("div",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:s}),c&&c.length>0&&(0,r.jsx)("ul",{className:"mt-3 space-y-1",children:c.map((e,t)=>{let a=e.match(/ðŸ”—\s*(https?:\/\/[^\s]+)/);if(a){let e=a[1];return(0,r.jsxs)("li",{className:"text-xs text-gray-600 dark:text-gray-400",children:["\uD83D\uDD17"," ",(0,r.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:underline",children:e})]},t)}return(0,r.jsx)("li",{className:"text-xs text-gray-600 dark:text-gray-400",children:e},t)})})]})}var g=a(5704);function w(){var e,t,a,d,u,w,v,f,x,p,y,b,S,F,k,C,N,j,D,M,L,A,T,R,P,Q,E,O,I,U,_,W,B,H,q,G,V,Z,J,z,K,X,Y,$,ee,et,ea,er,en,el,eo,es,ei,ec,ed,eu,em,eh,eg,ew,ev,ef,ex,ep,ey,eb,eS,eF,ek,eC,eN,ej,eD,eM,eL,eA,eT,eR,eP,eQ,eE,eO,eI,eU,e_,eW,eB,eH,eq,eG,eV,eZ,eJ,ez,eK,eX,eY,e$;let[e0,e1]=(0,n.useState)(null),[e4,e2]=(0,n.useState)(!0),[e5,e8]=(0,n.useState)(null),{preference:e3,setPreference:e6,isLoaded:e9}=function(){let[e,t]=(0,n.useState)("slack"),[a,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{try{var e;let a=localStorage.getItem(l);a&&(e=a,"string"==typeof e&&["slack","flood","ebb"].includes(e))&&t(a)}catch(e){console.warn("Failed to load tide preference from localStorage:",e)}finally{r(!0)}},[]),{preference:e,setPreference:e=>{try{localStorage.setItem(l,e),t(e)}catch(a){console.warn("Failed to save tide preference to localStorage:",a),t(e)}},isLoaded:a}}(),{cachedData:e7,setCachedData:te,isCacheValid:tt}=function(){let[e,t]=(0,n.useState)(null),[a,r]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{let e=function(){try{let e=localStorage.getItem(o);if(!e)return null;let t=JSON.parse(e);if(Date.now()>=t.expiresAt)return localStorage.removeItem(o),null;return t.data}catch(e){return console.warn("Failed to load conditions from cache:",e),null}}();e&&(t(e),r(!0))},[]),{cachedData:e,setCachedData:e=>{try{let t=Date.now();localStorage.setItem(o,JSON.stringify({data:e,cachedAt:t,expiresAt:t+3e5}))}catch(e){console.warn("Failed to save conditions to cache:",e)}t(e),r(!0)},isCacheValid:a,clearCache:()=>{try{localStorage.removeItem(o)}catch(e){console.warn("Failed to clear conditions cache:",e)}t(null),r(!1)}}}(),ta=(0,n.useRef)(null),tr=window.location.hostname.includes("github.io")||"static"===g.env.NEXT_PUBLIC_BUILD_MODE,tn=(e,t)=>{var a;let r=(e=>{if(e)return{slack:"slack"===e?100:85,flood:"flood"===e?100:85,ebb:"ebb"===e?100:85}})(t),n=function(e,t,a,r,n,l,o,d){var u;let m=function(e,t){let a=100,r=[],n="unknown",l="safe";if(e){if(void 0!==e.enterococcusCount){let t=e.enterococcusCount,o=s.waterQuality.enterococcus;t>o.dangerous?(a=0,n="dangerous",l="dangerous",r.push("Dangerous bacteria levels (".concat(t," MPN/100ml)"))):t>o.advisory?(a=30,n="high",l="warning",r.push("High bacteria levels (".concat(t," MPN/100ml)"))):t>o.safe?(a=70,n="moderate",l="advisory",r.push("Elevated bacteria levels (".concat(t," MPN/100ml)"))):n="safe"}}else a=50,l="advisory",n="unknown",r.push("No water quality data available");let o=(null!=t?t:[]).filter(e=>!(null==e?void 0:e.resolved)),i=(null!=t?t:[]).find(e=>!!(null==e?void 0:e.reportedAt)&&(Date.now()-e.reportedAt.getTime())/864e5<s.sso.cautionDays);if(o.length>0)a=Math.min(a,20),l="dangerous",r.push("Active sewer overflow nearby");else if(i){let e=Math.floor((Date.now()-i.reportedAt.getTime())/864e5);a=Math.min(a,60),"safe"===l&&(l="advisory"),r.push("Recent sewer overflow ".concat(e," days ago"))}return{score:a,status:l,bacteriaLevel:n,recentSSO:void 0!==i,daysSinceSSO:i?Math.floor((Date.now()-i.reportedAt.getTime())/864e5):void 0,issues:r}}(n,l),h=function(e,t,a){var r,n,l,o;let i=100,c=[],d=null!=(r=null==e?void 0:e.currentPhase)?r:"slack",u=null!=(n=null==t?void 0:t.speedKnots)?n:0,m=null!=(l=null==e?void 0:e.heightFeet)?l:0,h=null!=(o=null==e?void 0:e.changeRateFeetPerHour)?o:0;if(e&&null!=e.heightFeet){let e=(a||s.tide.phasePreference)[d];Math.abs(h)<s.tide.lowCurrent?i=e:Math.abs(h)<s.tide.moderateCurrent?(i=Math.min(.7*e,70),c.push("Moderate tide movement (".concat(d,")"))):(i=Math.min(.4*e,40),c.push("Strong tide movement (".concat(d,")"))),u>s.current.veryStrong?(i=Math.min(i,20),c.push("Very strong current (".concat(u.toFixed(1)," knots)"))):u>s.current.strong?(i=Math.min(i,40),c.push("Strong current (".concat(u.toFixed(1)," knots)"))):u>s.current.moderate&&(i=Math.min(i,65),c.push("Moderate current (".concat(u.toFixed(1)," knots)")))}else i=50,c.push("No tide data available");let g="slack"===d||u<s.current.slow;return{score:i,phase:d,currentSpeed:u,tideHeight:m,favorable:g,issues:c}}(e,t,d),g=function(e){var t;let a=100,r=[],n="calm",l=null!=(t=null==e?void 0:e.waveHeightFeet)?t:0;return 0!==l||(null==e?void 0:e.waveHeightFeet)?l<s.waves.calm?(a=100,n="calm"):l<s.waves.safe?(a=85,n="calm"):l<s.waves.moderate?(a=60,n="moderate",r.push("Moderate waves (".concat(l.toFixed(1)," ft)"))):l<s.waves.rough?(a=30,n="rough",r.push("Rough waves (".concat(l.toFixed(1)," ft)"))):(a=10,n="dangerous",r.push("Dangerous waves (".concat(l.toFixed(1)," ft)"))):(a=50,n="moderate",r.push("No wave data available")),{score:a,heightFeet:l,status:n,issues:r}}(r),w=function(e){var t,a,r,n;let l=100,o=[],i="calm",c=null!=(r=null==e?void 0:e.windSpeedMph)?r:0,d=null!=(n=null==e?void 0:e.temperatureF)?n:0;return 0!==c||(null==e?void 0:e.windSpeedMph)?c<s.wind.calm?i="calm":c<s.wind.light?(l=95,i="light"):c<s.wind.moderate?(l=80,i="moderate"):c<s.wind.strong?(l=60,i="moderate",o.push("Moderate winds (".concat(c.toFixed(0)," mph)"))):c<s.wind.veryStrong?(l=35,i="strong",o.push("Strong winds (".concat(c.toFixed(0)," mph)"))):(l=15,i="strong",o.push("Very strong winds (".concat(c.toFixed(0)," mph)"))):(l=50,i="moderate",o.push("No wind data available")),((null==e||null==(t=e.conditions)?void 0:t.includes("rain"))||(null==e||null==(a=e.conditions)?void 0:a.includes("storm")))&&(l=Math.min(l,40),o.push("Precipitation present")),{score:l,temperature:d,windSpeed:c,windCondition:i,issues:o}}(a),v=function(e){let t=100,a=[];if(!e)return t=75,a.push("Dam release data unavailable"),{score:t,totalFlowCFS:0,releaseLevel:"low",topContributor:"Unknown",issues:a};let{current:r,historical48h:n,dams:l}=e,o=s.damReleases,i=Math.max(.6*n.last24hAverage+.4*n.last48hAverage,.8*n.peakFlowCFS);i>o.extreme?(t=10,a.push("Extreme dam releases (48h peak: ".concat(Math.round(n.peakFlowCFS).toLocaleString()," CFS)")),a.push("Very strong currents expected - swimming not recommended")):i>o.high?(t=30,a.push("High dam releases (48h avg: ".concat(Math.round(n.averageFlowCFS).toLocaleString()," CFS)")),a.push("Strong currents - experienced swimmers only")):i>o.moderate?(t=65,a.push("Elevated dam releases (48h avg: ".concat(Math.round(n.averageFlowCFS).toLocaleString()," CFS)")),a.push("Increased current strength")):i>o.low?(t=75,a.push("Moderate dam releases (48h avg: ".concat(Math.round(n.averageFlowCFS).toLocaleString()," CFS)"))):t=100,"increasing"===n.trendDirection&&i>o.low&&a.push("Dam releases trending upward - conditions may worsen");let c=l.reduce((e,t)=>t.current.flowCFS>e.current.flowCFS?t:e,l[0]||{name:"Unknown",current:{flowCFS:0}});return{score:t,totalFlowCFS:r.totalFlowCFS,releaseLevel:r.releaseLevel,topContributor:c.name,issues:a}}(o),f=Math.round((m.score*i.waterQuality+h.score*i.tideAndCurrent+g.score*i.waves+w.score*i.weather+v.score*i.damReleases)/100),x=h.currentSpeed;x>=s.current.veryStrong?f=Math.min(f,39):x>=s.current.strong&&(f=Math.min(f,59)),"dangerous"===m.status?f=Math.min(f,19):"warning"===m.status&&(f=Math.min(f,39)),"dangerous"===g.status?f=Math.min(f,19):"rough"===g.status&&(f=Math.min(f,39));let p=(u=f)>=c.excellent.min?"excellent":u>=c.good.min?"good":u>=c.fair.min?"fair":u>=c.poor.min?"poor":"dangerous",y={waterQuality:m,tideAndCurrent:h,waves:g,weather:w,damReleases:v},{recommendations:b,warnings:S}=function(e,t){let a=[],r=[];return"dangerous"===e.waterQuality.status?r.push("Do not swim - dangerous water quality"):"warning"===e.waterQuality.status?r.push("Water quality warning in effect"):e.waterQuality.recentSSO&&r.push("Recent sewer overflow - use caution"),"slack"===e.tideAndCurrent.phase?a.push("Excellent time - slack tide"):e.tideAndCurrent.currentSpeed>1&&r.push("Strong currents - experienced swimmers only"),"dangerous"===e.waves.status?r.push("Dangerous wave conditions"):"rough"===e.waves.status?r.push("Rough seas - not recommended"):e.waves.heightFeet<2&&a.push("Calm water conditions"),"strong"===e.weather.windCondition&&r.push("Strong winds present"),"extreme"===e.damReleases.releaseLevel?r.push("Extreme dam releases - very strong currents expected"):"high"===e.damReleases.releaseLevel?r.push("High dam releases - strong bay currents"):"moderate"===e.damReleases.releaseLevel?a.push("Moderate dam releases - be aware of currents"):"low"===e.damReleases.releaseLevel&&a.push("Normal dam operations"),t>=80?a.push("Excellent conditions for swimming"):t>=60?a.push("Good conditions for swimming"):t>=40?a.push("Fair conditions - experienced swimmers recommended"):t>=20?r.push("Poor conditions - not recommended"):r.push("Dangerous conditions - do not swim"),{recommendations:a,warnings:r}}(y,f);return{timestamp:new Date,overallScore:f,rating:p,factors:y,recommendations:b,warnings:S}}(e.tide,e.current,e.weather,e.waves,e.waterQuality,e.recentSSOs||[],null!=(a=e.damReleases)?a:null,r);return{timestamp:new Date,...e,score:n}};async function tl(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{t||e2(!0);let a=tr?"/swimmingly/static-data.json":(()=>{let t=new URLSearchParams;return e&&t.append("tidePhasePreference",e),"/api/conditions".concat(t.toString()?"?".concat(t.toString()):"")})(),r=await fetch(a);if(!r.ok)throw Error("Failed to fetch conditions");let n=await r.json();if(n&&n.tide&&n.score){if(tr){ta.current={tide:n.tide,current:n.current,weather:n.weather,waves:n.waves,waterQuality:n.waterQuality,waterTemperature:n.waterTemperature,recentSSOs:n.recentSSOs,damReleases:n.damReleases,dataFreshness:n.dataFreshness};let t=tn(ta.current,e);te(t),e1(t)}else te(n),e1(n);e8(null)}else console.warn("Received incomplete data from API, keeping cached data"),!e0&&e7&&e1(e7)}catch(e){e8(e instanceof Error?e.message:"Unknown error")}finally{t||e2(!1)}}if((0,n.useEffect)(()=>{tt&&e7&&(e1(e7),e2(!1))},[tt,e7]),(0,n.useEffect)(()=>{if(e9){if(tr&&ta.current)return void e1(tn(ta.current,e3));tt&&e7?tl(e3,!0):tl(e3,!1)}},[e9,e3]),(0,n.useEffect)(()=>{if(!tr){let e=setInterval(()=>tl(e3,!0),3e5);return()=>clearInterval(e)}},[e3,tr]),e4)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading conditions..."})]})});if(e5)return(0,r.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-200 mb-2",children:"Error Loading Data"}),(0,r.jsx)("p",{className:"text-red-700 dark:text-red-300",children:e5}),(0,r.jsx)("button",{onClick:()=>tl(e3),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition",children:"Retry"})]});if(!e0)return null;let{score:to,tide:ts,current:ti,weather:tc,waves:td,waterQuality:tu,damReleases:tm}=e0,th=null!=(eS=null==to||null==(t=to.factors)||null==(e=t.waves)?void 0:e.heightFeet)?eS:0,tg=null!=(eF=null==td?void 0:td.swellPeriodSeconds)?eF:null,tw=null!=(ek=null==to||null==(d=to.factors)||null==(a=d.tideAndCurrent)?void 0:a.tideHeight)?ek:0,tv=null!=(eC=null==to||null==(w=to.factors)||null==(u=w.tideAndCurrent)?void 0:u.currentSpeed)?eC:0,tf=null!=(eN=null==to||null==(f=to.factors)||null==(v=f.weather)?void 0:v.windSpeed)?eN:0,tx=null!=(ej=null==to||null==(p=to.factors)||null==(x=p.weather)?void 0:x.temperature)?ej:0,tp=(null==tc?void 0:tc.source)||"unavailable",ty=tp.includes("open-meteo"),tb=ty?"Open-Meteo":"NOAA-NWS"===tp?"NOAA":"",tS=null==tc?void 0:tc.windGustMph,tF=null==tc?void 0:tc.windDirection,tk=(null==ts?void 0:ts.timestamp)?new Date(ts.timestamp):null,tC=(null==ti?void 0:ti.timestamp)?new Date(ti.timestamp):null,tN=tk&&tC?tk>tC?tk:tC:tk||tC,tj=(null==(y=e0.dataFreshness)?void 0:y.tide)?Math.floor((Date.now()-new Date(e0.dataFreshness.tide).getTime())/6e4):null,tD=tv>=s.current.veryStrong?"danger":tv>=s.current.strong?"warning":tv>=s.current.moderate?(null==to||null==(ez=to.factors)||null==(eJ=ez.tideAndCurrent)?void 0:eJ.favorable)?"info":"warning":(null==to||null==(eZ=to.factors)||null==(eV=eZ.tideAndCurrent)?void 0:eV.favorable)?"good":"info",tM="calm"===(eK=null!=(eD=null==to||null==(S=to.factors)||null==(b=S.waves)?void 0:b.status)?eD:"calm")?"good":"moderate"===eK?"warning":"rough"===eK||"dangerous"===eK?"danger":"info",tL="calm"===(eX=null!=(eM=null==to||null==(k=to.factors)||null==(F=k.weather)?void 0:F.windCondition)?eM:"calm")||"light"===eX?"good":"moderate"===eX?"warning":"strong"===eX?"danger":"info",tA="safe"===(eY=null!=(eL=null==to||null==(N=to.factors)||null==(C=N.waterQuality)?void 0:C.status)?eL:"safe")?"good":"advisory"===eY?"warning":"warning"===eY||"dangerous"===eY?"danger":"info",tT="low"===(e$=null!=(eA=null==to||null==(D=to.factors)||null==(j=D.damReleases)?void 0:j.releaseLevel)?eA:"low")?"good":"moderate"===e$?"info":"high"===e$?"warning":"extreme"===e$?"danger":"info";return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:()=>{confirm("Clear all cached data and refresh?")&&(localStorage.clear(),window.location.reload())},className:"text-xs px-3 py-1.5 bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 rounded-md transition-colors border border-gray-300 dark:border-gray-600",title:"Clear cached data and refresh",children:"\uD83D\uDDD1ï¸ Clear Cache"})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsx)(m,{score:to,tidePreference:e3,onTidePreferenceChange:e=>{if(e6(e),tr&&ta.current)return void e1(tn(ta.current,e));e2(!0),tl(e)},isPreferenceLoaded:e9})}),(0,r.jsxs)("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsx)(h,{title:"Tide & Current",value:tw.toFixed(1),unit:"ft",secondaryValue:tv.toFixed(2),secondaryUnit:"kt",threshold:"Slack <".concat(s.current.slack,"kt, Moderate <").concat(s.current.moderate,"kt, Strong <").concat(s.current.strong,"kt, Dangerous >").concat(s.current.veryStrong,"kt"),status:tD,icon:"\uD83C\uDF0A",details:["Phase: ".concat(null!=(eT=null==to||null==(L=to.factors)||null==(M=L.tideAndCurrent)?void 0:M.phase)?eT:"unknown"),...(()=>{let e=[];return(null==ts?void 0:ts.nextHigh)&&e.push({label:"Next high",timestamp:new Date(ts.nextHigh.timestamp),heightFeet:ts.nextHigh.heightFeet}),(null==ts?void 0:ts.nextLow)&&e.push({label:"Next low",timestamp:new Date(ts.nextLow.timestamp),heightFeet:ts.nextLow.heightFeet}),e.sort((e,t)=>e.timestamp.getTime()-t.timestamp.getTime()),e.map(e=>"".concat(e.label,": ").concat(e.timestamp.toLocaleTimeString("en-US",{timeZone:"America/Los_Angeles",hour:"numeric",minute:"2-digit",hour12:!0})," (").concat(e.heightFeet.toFixed(1)," ft)"))})(),tN?"Updated: ".concat(tN.toLocaleTimeString("en-US",{timeZone:"America/Los_Angeles",hour:"numeric",minute:"2-digit",hour12:!0})," PST").concat(tj&&tj>5?" (cached)":""):"",...null!=(eR=null==to||null==(R=to.factors)||null==(T=R.tideAndCurrent)||null==(A=T.issues)?void 0:A.filter(e=>!e.toLowerCase().includes("current")))?eR:[],"\uD83D\uDD17 https://tidesandcurrents.noaa.gov/noaatidepredictions.html?id=9414290"].filter(Boolean)}),(0,r.jsx)(h,{title:"Waves",value:th.toFixed(1),unit:"ft",threshold:"Calm <".concat(s.waves.calm,"ft, Safe <").concat(s.waves.safe,"ft, Moderate <").concat(s.waves.moderate,"ft, Rough <").concat(s.waves.rough,"ft"),status:tM,icon:"\uD83C\uDF0A",details:["Status: ".concat(null!=(eP=null==to||null==(Q=to.factors)||null==(P=Q.waves)?void 0:P.status)?eP:"unknown"),tg?"Period: ".concat(tg.toFixed(0),"s"):"",(null==(E=e0.waves)?void 0:E.source)?"Station: ".concat(e0.waves.source):"",(null==(O=e0.waves)?void 0:O.timestamp)?"Updated: ".concat(new Date(e0.waves.timestamp).toLocaleTimeString("en-US",{timeZone:"America/Los_Angeles",hour:"numeric",minute:"2-digit",hour12:!0})," PST"):"",(null==(U=e0.waves)||null==(I=U.source)?void 0:I.toLowerCase().includes("openwaterlog"))?"\uD83D\uDD17 https://openwaterlog.com/locations/aquatic-park/":(null==(W=e0.waves)||null==(_=W.source)?void 0:_.includes("NOAA-NDBC Buoy"))?"\uD83D\uDD17 https://www.ndbc.noaa.gov/station_page.php?station=".concat((null==(B=e0.waves.source.match(/\d{5}/))?void 0:B[0])||"46237"):"",...null!=(eQ=null==to||null==(q=to.factors)||null==(H=q.waves)?void 0:H.issues)?eQ:[]].filter(Boolean)}),(0,r.jsx)(h,{title:"Wind",value:tf.toFixed(0),unit:"mph",threshold:"Calm <".concat(s.wind.calm,"mph, Light <").concat(s.wind.light,"mph, Moderate <").concat(s.wind.moderate,"mph, Strong <").concat(s.wind.strong,"mph"),status:tL,icon:"\uD83D\uDCA8",details:["Condition: ".concat(null!=(eE=null==to||null==(V=to.factors)||null==(G=V.weather)?void 0:G.windCondition)?eE:"unknown"),tS?"Gusts: ".concat(tS.toFixed(0)," mph"):"",void 0!==tF?"Direction: ".concat(tF,"\xb0"):"","Air Temp: ".concat(tx.toFixed(0),"\xb0F"),(null==e0?void 0:e0.waterTemperature)?"Water Temp: ".concat(e0.waterTemperature.temperatureF.toFixed(1),"\xb0F (").concat(e0.waterTemperature.source,")"):"",(null==tc?void 0:tc.timestamp)?"Updated: ".concat(function(e){let t=Math.floor((new Date().getTime()-new Date(e).getTime())/6e4);if(0===t)return"just now";if(1===t)return"1 minute ago";if(t<60)return"".concat(t," minutes ago");let a=Math.floor(t/60);return 1===a?"1 hour ago":a<24?"".concat(a," hours ago"):new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}(tc.timestamp)):"",tb?"Source: ".concat(tb):"",...null!=(eO=null==to||null==(J=to.factors)||null==(Z=J.weather)?void 0:Z.issues)?eO:[],ty?"\uD83D\uDD17 https://open-meteo.com/":(null==tp?void 0:tp.includes("NOAA"))?"\uD83D\uDD17 https://www.weather.gov/":"",(null==e0?void 0:e0.waterTemperature)?"\uD83D\uDD17 https://seatemperature.info/aquatic-park-water-temperature.html":""].filter(Boolean)}),(0,r.jsx)(h,{title:"Water Quality",value:(null!=(eI=null==to||null==(K=to.factors)||null==(z=K.waterQuality)?void 0:z.status)?eI:"unknown").toUpperCase(),threshold:"Enterococcus: Safe â‰¤".concat(s.waterQuality.enterococcus.safe,", Advisory â‰¤").concat(s.waterQuality.enterococcus.advisory,", Warning â‰¤").concat(s.waterQuality.enterococcus.dangerous,", Dangerous >").concat(s.waterQuality.enterococcus.dangerous," | Coliform: Safe â‰¤").concat(s.waterQuality.coliform.safe,", Advisory â‰¤").concat(s.waterQuality.coliform.advisory,", Warning â‰¤").concat(s.waterQuality.coliform.dangerous,", Dangerous >").concat(s.waterQuality.coliform.dangerous," MPN/100ml"),status:tA,icon:"\uD83D\uDCA7",details:["Bacteria: ".concat(null!=(eU=null==to||null==(Y=to.factors)||null==(X=Y.waterQuality)?void 0:X.bacteriaLevel)?eU:"unknown"),(null==tu?void 0:tu.enterococcusCount)!==void 0?"Enterococcus: ".concat(tu.enterococcusCount.toFixed(0)," MPN/100ml"):"",(null==tu?void 0:tu.coliformCount)!==void 0?"Total Coliform: ".concat(tu.coliformCount.toFixed(0)," MPN/100ml"):"",(null==to||null==(ee=to.factors)||null==($=ee.waterQuality)?void 0:$.recentSSO)?"SSO ".concat(null!=(e_=null==to||null==(ea=to.factors)||null==(et=ea.waterQuality)?void 0:et.daysSinceSSO)?e_:"?"," days ago"):"",(null==tu?void 0:tu.notes)||"",(null==tu?void 0:tu.source)?"Source: ".concat(tu.source):"",(null==tu?void 0:tu.stationId)?"Station: ".concat(tu.stationId):"",(null==tu||null==(er=tu.source)?void 0:er.includes("SF Beach Water Quality"))?"\uD83D\uDD17 https://data.sfgov.org/Energy-and-Environment/Beach-Water-Quality-Monitoring/v3fv-x3ux":(null==tu||null==(en=tu.source)?void 0:en.includes("California Water Quality"))?"\uD83D\uDD17 https://data.ca.gov/dataset/surface-water-fecal-indicator-bacteria-results/resource/15a63495-8d9f-4a49-b43a-3092ef3106b9":(null==tu||null==(el=tu.source)?void 0:el.includes("Water Quality Portal"))?"\uD83D\uDD17 https://www.waterqualitydata.us/":"",...null!=(eW=null==to||null==(es=to.factors)||null==(eo=es.waterQuality)?void 0:eo.issues)?eW:[]].filter(Boolean)}),(0,r.jsx)(h,{title:"Dam Releases",value:(null==to||null==(ec=to.factors)||null==(ei=ec.damReleases)?void 0:ei.totalFlowCFS)?Math.round(to.factors.damReleases.totalFlowCFS/1e3).toString()+"k":"0",unit:"CFS",threshold:"Low <".concat(s.damReleases.moderate.toLocaleString(),"CFS, Moderate <").concat(s.damReleases.high.toLocaleString(),"CFS, High <").concat(s.damReleases.extreme.toLocaleString(),"CFS"),status:tT,icon:"\uD83C\uDFD4ï¸",details:["Level: ".concat(null!=(eB=null==to||null==(eu=to.factors)||null==(ed=eu.damReleases)?void 0:ed.releaseLevel)?eB:"unknown"),"Current: ".concat(null!=(eH=null==to||null==(eg=to.factors)||null==(eh=eg.damReleases)||null==(em=eh.totalFlowCFS)?void 0:em.toLocaleString())?eH:"0"," CFS"),(null==tm||null==(ew=tm.historical48h)?void 0:ew.averageFlowCFS)?"48h Average: ".concat(Math.round(tm.historical48h.averageFlowCFS).toLocaleString()," CFS"):"",(null==tm||null==(ev=tm.historical48h)?void 0:ev.peakFlowCFS)?"48h Peak: ".concat(Math.round(tm.historical48h.peakFlowCFS).toLocaleString()," CFS"):"",(null==tm||null==(ef=tm.historical48h)?void 0:ef.trendDirection)?"Trend: ".concat("increasing"===tm.historical48h.trendDirection?"â†—ï¸ Increasing":"decreasing"===tm.historical48h.trendDirection?"â†˜ï¸ Decreasing":"â†’ Stable"):"","â±ï¸ Dam releases take 24-48 hours to reach SF Bay","Score reflects recent releases affecting current conditions","Top Source: ".concat(null!=(eq=null==to||null==(ep=to.factors)||null==(ex=ep.damReleases)?void 0:ex.topContributor)?eq:"Unknown"),...(null==tm?void 0:tm.dams.filter(e=>e.current.flowCFS>0).sort((e,t)=>t.current.flowCFS-e.current.flowCFS).slice(0,3).map(e=>{var t;return"".concat(e.name,": ").concat(Math.round(e.current.flowCFS).toLocaleString()," CFS (").concat(e.current.percentOfTotal.toFixed(0),"%)")+((null==(t=e.historical48h)?void 0:t.peakFlowCFS)?" - 48h peak: ".concat(Math.round(e.historical48h.peakFlowCFS).toLocaleString()):"")}))||[],(null==tm?void 0:tm.latestDataTimestamp)?"Latest Data: ".concat(new Date(tm.latestDataTimestamp).toLocaleTimeString("en-US",{timeZone:"America/Los_Angeles",hour:"numeric",minute:"2-digit",hour12:!0})," PST"):"",...null!=(eG=null==to||null==(eb=to.factors)||null==(ey=eb.damReleases)?void 0:ey.issues)?eG:[],"\uD83D\uDD17 https://cdec.water.ca.gov/"].filter(Boolean)})]})]})]})}},9620:(e,t,a)=>{Promise.resolve().then(a.bind(a,2524))}},e=>{e.O(0,[441,255,358],()=>e(e.s=9620)),_N_E=e.O()}]);